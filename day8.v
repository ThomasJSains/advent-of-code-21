Require Import Coq.Lists.List.
Require Import Coq.Strings.String.
Require Import Coq.Init.Nat.

Open Scope list_scope.
Open Scope string_scope.
Open Scope nat_scope.

Import ListNotations.
Import StringSyntax.

Definition data := [ ["fdcab" ; "adbcf" ; "gcb" ; "acdebf"] ; ["dbfg" ; "abecf" ; "dfgb" ; "gaecdf"] ; ["fag" ; "edcgf" ; "fga" ; "bfgcad"] ; ["fcdea" ; "abdc" ; "fdcbea" ; "fdbcega"] ; ["fagedc" ; "bgc" ; "bgace" ; "cbg"] ; ["fd" ; "fd" ; "ecfgd" ; "gfbcea"] ; ["fcg" ; "gfc" ; "fgc" ; "dfcega"] ; ["gea" ; "fgcbade" ; "ea" ; "ega"] ; ["agebcdf" ; "cadg" ; "agbfed" ; "cd"] ; ["debacfg" ; "bga" ; "degcfb" ; "bacgfde"] ; ["gaebdf" ; "cabf" ; "aegbdf" ; "fegba"] ; ["gabced" ; "gd" ; "bcdag" ; "ebgd"] ; ["adbfgc" ; "ecfdbga" ; "ebfcg" ; "ab"] ; ["dbega" ; "dgecbfa" ; "adbce" ; "fecbadg"] ; ["dfbe" ; "gfdbc" ; "fcb" ; "bf"] ; ["bec" ; "dgeb" ; "ceagf" ; "egfcbda"] ; ["agfcbe" ; "bcadge" ; "abc" ; "cab"] ; ["fbcg" ; "cfadg" ; "geafbd" ; "deabc"] ; ["dfcbgae" ; "ec" ; "fecga" ; "caed"] ; ["cgfbad" ; "abdge" ; "bec" ; "badcfe"] ; ["debga" ; "faedcb" ; "acgeb" ; "fgdeb"] ; ["dcaeg" ; "egdfabc" ; "dagbfc" ; "dgabcf"] ; ["aegcbf" ; "decfga" ; "gb" ; "aecgf"] ; ["efcdag" ; "cabg" ; "geadbf" ; "ab"] ; ["bac" ; "cgeb" ; "cb" ; "cfaedb"] ; ["gbe" ; "eg" ; "bgfde" ; "gafe"] ; ["bcgafed" ; "beac" ; "abd" ; "caeb"] ; ["dcfegb" ; "fbgea" ; "cagdebf" ; "cefdbg"] ; ["afdgecb" ; "efadb" ; "daegfbc" ; "gdfba"] ; ["cfae" ; "dbcef" ; "ade" ; "debcgf"] ; ["fdcabge" ; "abeg" ; "fbcagd" ; "gb"] ; ["cbgfe" ; "gefd" ; "fedg" ; "fbecg"] ; ["fdagb" ; "deac" ; "adec" ; "cga"] ; ["ebdga" ; "fbegd" ; "fg" ; "fbg"] ; ["fb" ; "bf" ; "bcfg" ; "gcfea"] ; ["cfeda" ; "cagf" ; "ag" ; "dfcea"] ; ["edfbg" ; "ef" ; "dbfge" ; "fe"] ; ["cfegb" ; "ab" ; "gfadcbe" ; "dgbcfe"] ; ["cfaedb" ; "cbgae" ; "afc" ; "cdebfa"] ; ["bgcafd" ; "ca" ; "cag" ; "ac"] ; ["gf" ; "egdbaf" ; "afegb" ; "egfd"] ; ["cgfead" ; "dcaef" ; "dba" ; "edfb"] ; ["dg" ; "dg" ; "gd" ; "dgc"] ; ["aeg" ; "cedfagb" ; "bacfged" ; "eagdc"] ; ["ecfagbd" ; "gabec" ; "gebda" ; "ed"] ; ["edcbga" ; "abe" ; "baecfgd" ; "dbaf"] ; ["feac" ; "adcegfb" ; "gbfdae" ; "edgafbc"] ; ["dbgace" ; "febda" ; "fdgbac" ; "dgebac"] ; ["egbcf" ; "dfb" ; "gcefabd" ; "degcbf"] ; ["fdecbga" ; "ab" ; "bfa" ; "fbegd"] ; ["gdacbe" ; "gbfed" ; "cb" ; "dfbc"] ; ["cdgafb" ; "dabeg" ; "fdgcab" ; "adcfg"] ; ["dcafb" ; "gbedcf" ; "facgedb" ; "acb"] ; ["egfdbc" ; "gcefba" ; "dgbfe" ; "adcgefb"] ; ["dfecag" ; "de" ; "gaecfdb" ; "gcefda"] ; ["bafegd" ; "dgfb" ; "bdafe" ; "daebgf"] ; ["cgbea" ; "dgc" ; "gfabedc" ; "cdg"] ; ["ecfbgd" ; "cfegd" ; "fa" ; "bgdefc"] ; ["gcefbd" ; "efacdbg" ; "acfegbd" ; "ebgf"] ; ["fe" ; "afceg" ; "fe" ; "gecdfb"] ; ["cgfbda" ; "agcef" ; "afgbe" ; "egcdfb"] ; ["dafbg" ; "dfbcge" ; "dagfbc" ; "fcega"] ; ["cb" ; "bgc" ; "egfdcb" ; "abegcf"] ; ["egfbda" ; "bfcgade" ; "ad" ; "feabgcd"] ; ["fcged" ; "afcgde" ; "dgcafe" ; "gdbecfa"] ; ["faebdc" ; "fdagbe" ; "dgebf" ; "bgfa"] ; ["adfcge" ; "gfadce" ; "ab" ; "bga"] ; ["begfd" ; "gfbcae" ; "dae" ; "eda"] ; ["cdagfeb" ; "efba" ; "abc" ; "ab"] ; ["dacfge" ; "fgabec" ; "gde" ; "fecgdab"] ; ["fdaeg" ; "efgab" ; "ceagfd" ; "efbga"] ; ["ecfgd" ; "bcef" ; "deb" ; "dbgaf"] ; ["bgafce" ; "afecdbg" ; "fcdae" ; "egcb"] ; ["gdefc" ; "cgedfab" ; "gdcbaf" ; "efcb"] ; ["cfedgab" ; "bdfa" ; "cbd" ; "cdgbea"] ; ["bgecfda" ; "gbefda" ; "gbd" ; "gcfabed"] ; ["acbdfg" ; "cedagb" ; "ga" ; "gdeca"] ; ["cedf" ; "gbaced" ; "fc" ; "dfgecab"] ; ["fgbce" ; "febdgca" ; "adbgfce" ; "gac"] ; ["gad" ; "gace" ; "gfeadb" ; "afdgeb"] ; ["cgdab" ; "dbfage" ; "fbcg" ; "dgc"] ; ["fcabde" ; "bc" ; "bdcfa" ; "abedcf"] ; ["gbf" ; "dbfcea" ; "gb" ; "cbfad"] ; ["cfa" ; "bfcaed" ; "cebdaf" ; "cafdeb"] ; ["fcegbad" ; "gbecda" ; "begda" ; "fegbad"] ; ["dgfcbea" ; "cd" ; "acfegb" ; "cdefab"] ; ["fegadb" ; "gba" ; "cfage" ; "ba"] ; ["gfdbe" ; "dgecfb" ; "bdgeca" ; "eafgdcb"] ; ["cgbae" ; "fc" ; "cgbaed" ; "cbf"] ; ["gcbfae" ; "ceabfdg" ; "eadgcfb" ; "ca"] ; ["bgcafd" ; "gdbfac" ; "dbcgaf" ; "dcab"] ; ["edgabf" ; "cabegdf" ; "ec" ; "bdcagef"] ; ["egf" ; "fgdc" ; "dcgaefb" ; "gfceadb"] ; ["deag" ; "fgdba" ; "bfeagdc" ; "efacgb"] ; ["cbdeg" ; "bcegd" ; "cbdage" ; "bdf"] ; ["cbdfaeg" ; "abgcedf" ; "egacbf" ; "becdfga"] ; ["egcab" ; "facdbg" ; "edgfc" ; "af"] ; ["gdabf" ; "fge" ; "adegcbf" ; "aebdgfc"] ; ["cb" ; "bdfc" ; "dafebc" ; "gceadfb"] ; ["gcdba" ; "cfegad" ; "cdfabe" ; "fgbe"] ; ["dfgceb" ; "cgb" ; "cbaedgf" ; "cgefbad"] ; ["gfacbde" ; "efbagd" ; "egcdb" ; "fbegdca"] ; ["gaecbfd" ; "dgfbc" ; "afb" ; "dfaebc"] ; ["fadce" ; "abd" ; "feacd" ; "bdcg"] ; ["eg" ; "cegfbd" ; "dabfgc" ; "eafcb"] ; ["facde" ; "fac" ; "ca" ; "ecfadgb"] ; ["cb" ; "cdbfega" ; "dbc" ; "fbcg"] ; ["cbedfg" ; "acgdf" ; "bacfd" ; "fbc"] ; ["fea" ; "gceda" ; "edcagf" ; "fabdge"] ; ["efdagb" ; "afgecbd" ; "fdgab" ; "bged"] ; ["gcbfaed" ; "fadeg" ; "bf" ; "cfdeab"] ; ["gcabd" ; "cdg" ; "dabgc" ; "gbfad"] ; ["ecbfg" ; "gabefc" ; "fgecbad" ; "deb"] ; ["fadce" ; "bdaefg" ; "dbfgca" ; "dfgbaec"] ; ["daegb" ; "fd" ; "efdgb" ; "bafd"] ; ["adgcfbe" ; "cdeabfg" ; "fg" ; "fgae"] ; ["cbf" ; "fcaed" ; "fbc" ; "fcebd"] ; ["ged" ; "edg" ; "fegadb" ; "gedaf"] ; ["cbadfeg" ; "fgabe" ; "feagb" ; "cfg"] ; ["gac" ; "agc" ; "edgfc" ; "acgdf"] ; ["facged" ; "cg" ; "acfde" ; "cge"] ; ["fc" ; "caegbdf" ; "abedfg" ; "aebgfc"] ; ["dcgbeaf" ; "agdceb" ; "bfecag" ; "bedf"] ; ["gcbadef" ; "daec" ; "bdgac" ; "ebgac"] ; ["dg" ; "gdbe" ; "dbgace" ; "cgd"] ; ["bdcag" ; "ca" ; "ceadbgf" ; "dfac"] ; ["afdbe" ; "bfdgcae" ; "afbg" ; "gbfa"] ; ["abcfd" ; "gad" ; "afcbeg" ; "gd"] ; ["defagbc" ; "cge" ; "ecagfb" ; "ge"] ; ["ae" ; "dbefcga" ; "efbad" ; "ade"] ; ["bc" ; "abcf" ; "cgb" ; "bcg"] ; ["egcbdf" ; "bgc" ; "edcfba" ; "bgc"] ; ["febc" ; "cebf" ; "bacedgf" ; "fbgedc"] ; ["gbc" ; "gcef" ; "cbg" ; "fadgbc"] ; ["bg" ; "beadgfc" ; "cbge" ; "gb"] ; ["decf" ; "cf" ; "fc" ; "cf"] ; ["cgdfb" ; "fgcbd" ; "ab" ; "dbca"] ; ["geb" ; "dfbg" ; "bfdg" ; "cdbea"] ; ["fea" ; "cdbfge" ; "gdcefba" ; "fdgbe"] ; ["agebfd" ; "cfabdg" ; "ebaf" ; "afeb"] ; ["cdeg" ; "cdegab" ; "dbeca" ; "gaceb"] ; ["efdbc" ; "gfdacb" ; "bdc" ; "ecfba"] ; ["gd" ; "efcagdb" ; "gacbf" ; "dbefac"] ; ["gae" ; "ga" ; "bgad" ; "adbfec"] ; ["decfa" ; "fedca" ; "efadcb" ; "fcg"] ; ["dcafebg" ; "ae" ; "egdabfc" ; "ae"] ; ["dbaec" ; "edfg" ; "gfed" ; "aegbf"] ; ["efba" ; "gbe" ; "bfgcd" ; "degaf"] ; ["beadgf" ; "aedf" ; "bgade" ; "efda"] ; ["dcagf" ; "fgebcd" ; "cef" ; "bcefadg"] ; ["bcfde" ; "cd" ; "dc" ; "befdg"] ; ["cdgfb" ; "gdcafe" ; "bfgce" ; "acfedg"] ; ["dfbgc" ; "adbfgc" ; "cefdga" ; "ce"] ; ["bcega" ; "ecgdb" ; "ceabfgd" ; "gebdc"] ; ["gabcf" ; "ecbdaf" ; "dcfg" ; "fg"] ; ["feac" ; "ebfdgc" ; "ecgbfd" ; "gdeba"] ; ["da" ; "dag" ; "fgcba" ; "ad"] ; ["dgfa" ; "ead" ; "fgad" ; "dbfgec"] ; ["ed" ; "bade" ; "de" ; "afdceb"] ; ["cdaefb" ; "defgbac" ; "gae" ; "dagb"] ; ["cbeadgf" ; "fg" ; "fg" ; "cgf"] ; ["ge" ; "ecadbg" ; "ecabgd" ; "ega"] ; ["feda" ; "agd" ; "cdgabe" ; "bcafdge"] ; ["fcgbde" ; "bfage" ; "cgfea" ; "fbecgd"] ; ["fdcgaeb" ; "bg" ; "gbfcea" ; "afbgd"] ; ["bcadfeg" ; "gcfeb" ; "daegfb" ; "caeb"] ; ["agf" ; "fa" ; "faed" ; "fga"] ; ["gebdfa" ; "aefgb" ; "deaf" ; "cbedg"] ; ["ed" ; "cbfda" ; "de" ; "cbfeag"] ; ["gbae" ; "cefba" ; "aec" ; "gfbec"] ; ["bfgd" ; "egdaf" ; "gb" ; "bag"] ; ["gfce" ; "ega" ; "dfcbga" ; "gfedacb"] ; ["egfdcab" ; "gcdfe" ; "bgeca" ; "adc"] ; ["bae" ; "ecgab" ; "cbfga" ; "gfae"] ; ["cf" ; "agbdf" ; "caefdbg" ; "fegdcb"] ; ["cdabe" ; "gbdea" ; "eacfgd" ; "adc"] ; ["ecfba" ; "cafge" ; "be" ; "be"] ; ["baecdf" ; "adgeb" ; "ade" ; "cbfadeg"] ; ["abdge" ; "abgfde" ; "gfdb" ; "eagfdb"] ; ["bag" ; "cbedag" ; "agdfceb" ; "dfcba"] ; ["afde" ; "eafd" ; "ceadgb" ; "cdbage"] ; ["ebdgca" ; "gec" ; "ecbdaf" ; "dbafec"] ; ["ac" ; "eacbdf" ; "caf" ; "ecdgbf"] ; ["dcaeb" ; "cfad" ; "dfe" ; "fcad"] ; ["cgbd" ; "aecgb" ; "bgcea" ; "ebd"] ; ["ecdfgb" ; "daegfb" ; "bfegc" ; "ecfbg"] ; ["dbaecf" ; "efgcd" ; "fgedab" ; "fgdeac"] ; ["egacdbf" ; "gebfc" ; "ae" ; "ega"] ; ["afedg" ; "fa" ; "abgced" ; "gacbdf"] ; ["cd" ; "dcb" ; "dgca" ; "decbg"] ; ["becafg" ; "bgdf" ; "fcb" ; "gecdbf"] ; ["gaefbcd" ; "degca" ; "fcge" ; "dbcfeag"] ; ["defca" ; "fecab" ; "cdaeg" ; "ecafb"] ; ["gcdfa" ; "cdab" ; "dcab" ; "bcfeagd"] ; ["gf" ; "bdcgfa" ; "dgafe" ; "bgcdaf"] ; ["ecdgbf" ; "ad" ; "bgcdef" ; "abgef"] ; ["gedafb" ; "acbdegf" ; "aeb" ; "eb"] ; ["fadecbg" ; "bgfe" ; "ef" ; "agdbf"] ; ["bdacgf" ; "adfbc" ; "bg" ; "gedca"] ; ["geda" ; "aegd" ; "gcdafb" ; "dcefab"] ].

Definition flat_data := flat_map (fun (x : list string) => x) data.

Definition is_length (n : nat) (s : string) := ((length s) =? n).

Definition count_of_length (n : nat) := Datatypes.length (filter (is_length n) flat_data).

Definition sum (l : list nat) := fold_left plus l 0.

Definition part1 := sum (map count_of_length [2; 3; 4; 7]).

Compute part1.